---
import { humanize, slugify } from "@/lib/utils/textConverter";
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import placeholder from "@/assets/images/placeholder.png";
import dateFormat from "@/lib/utils/dateFormat";

type Props = {
  posts: CollectionEntry<"posts">[];
  className?: string;
  fluid?: boolean;
};
const { className, posts, fluid } = Astro.props;
---

<div class={`grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-12 ${className}`}>
  {posts.map((post, i: number) => {
      const postImage = post.data.image || placeholder;
      return (
        <article class="group col-span-1">
          {postImage && (
            <a href={`/blog/${post.id}`} class="block mb-6 overflow-hidden rounded-2xl shadow-sm border border-gray-100">
              <Image
                loading={i < 2 ? "eager" : "lazy"}
                class="group-hover:scale-[1.03] transition duration-500 w-full aspect-[16/9] object-cover"
                src={postImage}
                alt={post.data.image_alt || post.data.title}
                width={800} height={450} format="webp"
              />
            </a>
          )}
          <div class="flex items-center space-x-3 mb-3">
              {post.data.categories && (
                  <a href={`/categorias/${slugify(post.data.categories[0])}`} class="text-dark text-xs font-bold uppercase tracking-wider hover:underline">
                      {humanize(post.data.categories[0])}
                  </a>
              )}
              <span class="text-slate-300 text-xs px-1">•</span>
              <time class="text-slate-500 text-sm font-medium">{dateFormat(post.data.date)}</time>
          </div>
          <h3 class="font-primary text-2xl md:text-3xl font-bold text-dark group-hover:text-slate-600 transition-colors mb-4 leading-tight">
            <a href={`/blog/${post.id}`} class="block">{post.data.title}</a>
          </h3>
          <p class="text-text leading-relaxed line-clamp-3">
            {post.data.description || "Leia a reflexão completa sobre este tema."}
          </p>
        </article>
      );
  })}
</div>
