---
import Base from "@/layouts/Base.astro";
import { getSinglePage } from "@/lib/contentParser.astro";
import { sortByDate } from "@/lib/utils/sortFunctions";
import dateFormat from "@/lib/utils/dateFormat";
import { humanize, slugify } from "@/lib/utils/textConverter";

const posts = await getSinglePage("posts");
const sortedPosts = sortByDate(posts).slice(0, 4);
---

<Base>
  <section class="relative bg-dark pt-20 pb-16 sm:pt-28 sm:pb-24 lg:pt-40 lg:pb-32 overflow-hidden -mt-[72px]">
      <div class="absolute inset-0 bg-gradient-to-br from-dark to-slate-800 opacity-90"></div>
      <div class="absolute top-0 right-0 -mt-20 -mr-20 w-64 h-64 sm:w-80 sm:h-80 bg-primary rounded-full blur-[100px] sm:blur-[120px] opacity-20"></div>
      
      <div class="relative max-w-4xl mx-auto px-4 sm:px-6 text-center z-10 mt-[72px]">
          <span class="text-primary font-semibold tracking-widest text-[10px] sm:text-xs uppercase mb-4 block">Dan Coelho | Engenharia da Alma & Teologia</span>
          <h1 class="font-primary text-4xl sm:text-5xl md:text-7xl font-bold text-white leading-tight mb-6 sm:mb-8">
              Clareza para mentes exaustas. <br/> <span class="text-primary italic font-medium">Graça para líderes.</span>
          </h1>
          <p class="text-slate-300 text-base sm:text-lg md:text-xl font-secondary font-light mb-8 sm:mb-10 max-w-2xl mx-auto leading-relaxed px-2">
              A intersecção onde a precisão da gestão de alta performance encontra a profunda neuroplasticidade da fé.
          </p>
          
          <form class="flex flex-col sm:flex-row justify-center max-w-lg mx-auto gap-3 px-2">
              <input type="email" placeholder="O seu melhor e-mail..." class="w-full px-5 py-3 sm:py-4 bg-white/10 border border-white/20 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary transition-all backdrop-blur-sm" required/>
              <button type="button" class="w-full sm:w-auto bg-primary hover:bg-[#d97706] text-dark px-8 py-3 sm:py-4 rounded-md font-semibold transition-all shadow-lg">
                  Assinar Grátis
              </button>
          </form>
      </div>
  </section>

  <section id="manifesto" class="max-w-6xl mx-auto px-4 sm:px-6 py-20 -mt-10 relative z-20">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="bg-white p-8 rounded-xl shadow-lg border border-gray-100">
              <div class="w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center mb-6">
                  <svg class="w-6 h-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
              </div>
              <h3 class="font-primary text-xl font-bold text-dark mb-3">Neurociência da Fé</h3>
              <p class="text-sm text-text leading-relaxed">As vitórias sinápticas e como a renovação da mente é um processo biológico desenhado pelo Criador.</p>
          </div>
          <div class="bg-white p-8 rounded-xl shadow-lg border border-gray-100">
              <div class="w-12 h-12 bg-amber-50 rounded-lg flex items-center justify-center mb-6">
                  <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
              </div>
              <h3 class="font-primary text-xl font-bold text-dark mb-3">Alta Performance</h3>
              <p class="text-sm text-text leading-relaxed">Ferramentas de Engenharia e Gestão aplicadas à liderança de equipes e ministérios.</p>
          </div>
          <div class="bg-white p-8 rounded-xl shadow-lg border border-gray-100">
              <div class="w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center mb-6">
                  <svg class="w-6 h-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
              </div>
              <h3 class="font-primary text-xl font-bold text-dark mb-3">Teologia Prática</h3>
              <p class="text-sm text-text leading-relaxed">O evangelho que o mundo não quer ouvir. Respostas críticas baseadas no Getsêmani e no amor prático.</p>
          </div>
      </div>
  </section>

  <section id="ensaios" class="max-w-4xl mx-auto px-4 sm:px-6 py-10">
      <div class="flex flex-col md:flex-row justify-between items-end mb-10 border-b border-gray-200 pb-4">
          <div>
              <h2 class="font-primary text-3xl font-bold text-dark">Últimos Ensaios</h2>
              <p class="text-text mt-1 text-sm">Reflexões recentes enviadas aos domingos.</p>
          </div>
          <a href="/categorias" class="hidden md:inline-block text-dark font-bold hover:underline mb-1">Explorar por Temas &rarr;</a>
      </div>

      <div class="space-y-10">
          {sortedPosts.map((post) => (
              <article class="group">
                  <div class="flex items-center space-x-3 mb-2">
                      {post.data.categories && (
                          <a href={`/categorias/${slugify(post.data.categories[0])}`} class="text-dark text-xs font-bold uppercase tracking-wider hover:underline">
                              {humanize(post.data.categories[0])}
                          </a>
                      )}
                      <span class="text-slate-400 text-xs px-2">•</span>
                      <time class="text-slate-500 text-xs font-medium">{dateFormat(post.data.date)}</time>
                  </div>
                  <a href={`/blog/${post.id}`} class="block">
                      <h3 class="font-primary text-2xl font-bold text-dark group-hover:text-slate-600 transition-colors mb-3 leading-tight">
                          {post.data.title}
                      </h3>
                      <p class="text-text leading-relaxed line-clamp-2">
                          {post.data.description || "Leia a reflexão completa sobre este tema."}
                      </p>
                  </a>
              </article>
          ))}
      </div>
      <a href="/categorias" class="md:hidden block text-center text-dark font-bold hover:underline mt-8">Explorar por Temas &rarr;</a>
  </section>

  <section id="livros" class="max-w-6xl mx-auto px-4 sm:px-6 py-16 mb-10 bg-slate-50 mt-16 rounded-3xl border border-gray-100">
      <div class="flex flex-col mb-12 text-center">
          <h2 class="font-primary text-3xl sm:text-4xl font-bold text-dark">A Biblioteca</h2>
          <p class="text-text mt-2 max-w-xl mx-auto">Manuais práticos para a sua mente e liderança. Pague o quanto quiser. O conhecimento não deve ter barreiras.</p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12">
          <div class="flex flex-col sm:flex-row gap-6 bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-xl transition-shadow">
              <div class="w-full sm:w-1/3 bg-dark rounded-lg aspect-[2/3] flex items-center justify-center text-primary font-primary font-bold text-center px-4 leading-tight shadow-inner">
                 O Principal Mandamento
              </div>
              <div class="w-full sm:w-2/3 flex flex-col justify-center">
                  <span class="text-xs font-bold uppercase tracking-wider text-dark mb-2">Lançamento</span>
                  <h3 class="font-primary text-2xl font-bold text-dark mb-2">O Principal Mandamento</h3>
                  <p class="text-sm text-text mb-6 line-clamp-3">O Evangelho que o mundo não quer ouvir. Uma desconstrução do nosso orgulho diante da simplicidade do amor de Cristo.</p>
                  <button class="bg-dark hover:bg-black text-white w-full sm:w-auto text-center px-6 py-3 rounded-md text-sm font-semibold transition-colors shadow-md">
                      Baixar Obra (R$ 0,00+)
                  </button>
              </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-6 bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-xl transition-shadow">
              <div class="w-full sm:w-1/3 bg-slate-200 rounded-lg aspect-[2/3] flex items-center justify-center text-dark font-primary font-bold text-center px-4 leading-tight shadow-inner border border-gray-300">
                Gestão de Pessoas
              </div>
              <div class="w-full sm:w-2/3 flex flex-col justify-center">
                  <span class="text-xs font-bold uppercase tracking-wider text-slate-600 mb-2">Business & Fé</span>
                  <h3 class="font-primary text-2xl font-bold text-dark mb-2">Gestão de Pessoas</h3>
                  <p class="text-sm text-text mb-6 line-clamp-3">Para Alta Performance. Desvendando o Potencial Humano para Resultados Extraordinários nas empresas e ministérios.</p>
                  <button class="bg-dark hover:bg-black text-white w-full sm:w-auto text-center px-6 py-3 rounded-md text-sm font-semibold transition-colors shadow-md">
                      Baixar Obra (R$ 0,00+)
                  </button>
              </div>
          </div>
      </div>
  </section>
</Base>
