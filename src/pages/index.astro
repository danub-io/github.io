---
import Base from "@/layouts/Base.astro";
import { getSinglePage } from "@/lib/contentParser.astro";
import { sortByDate } from "@/lib/utils/sortFunctions";
import dateFormat from "@/lib/utils/dateFormat";
import { humanize, slugify } from "@/lib/utils/textConverter";

const posts = await getSinglePage("posts");
const sortedPosts = sortByDate(posts).slice(0, 5); // Últimos 5 textos
---

<Base>
  <section class="pt-32 pb-20 md:pt-48 md:pb-32 px-6 border-b border-gray-200 bg-white">
      <div class="max-w-4xl mx-auto text-center">
          <span class="text-primary font-bold tracking-[0.2em] text-xs uppercase mb-6 block">Refúgio Literário de Dan Coelho</span>
          <h1 class="font-primary text-5xl md:text-7xl font-bold text-dark leading-[1.1] mb-8">
              Clareza para mentes exaustas. <br class="hidden md:block"/> <span class="text-primary italic font-medium">Graça para líderes reais.</span>
          </h1>
          <p class="text-gray-600 text-lg md:text-2xl font-light mb-12 max-w-2xl mx-auto leading-relaxed">
              Onde a precisão da gestão de alta performance encontra a profunda neuroplasticidade da fé.
          </p>
          
          <form class="flex flex-col sm:flex-row justify-center max-w-lg mx-auto gap-3">
              <input type="email" placeholder="Seu melhor e-mail..." class="w-full px-6 py-4 bg-gray-50 border border-gray-200 rounded-lg text-dark placeholder-gray-400 focus:border-primary focus:ring-1 focus:ring-[#b8905b] outline-none transition-all" required/>
              <button type="submit" class="w-full sm:w-auto bg-dark hover:bg-gray-800 text-white px-8 py-4 rounded-lg font-semibold transition-all shadow-md whitespace-nowrap">
                  Ler aos Domingos
              </button>
          </form>
          <p class="text-xs text-gray-400 mt-4">100% gratuito. Cancele quando quiser.</p>
      </div>
  </section>

  <section id="ensaios" class="py-20 md:py-32 px-6 bg-body">
      <div class="max-w-4xl mx-auto">
          <div class="flex justify-between items-end mb-16 border-b-2 border-dark pb-4">
              <h2 class="font-primary text-3xl md:text-4xl font-bold text-dark">Ensaios Recentes</h2>
              <a href="/categorias" class="hidden md:block text-sm font-bold uppercase tracking-wider text-gray-500 hover:text-primary transition">Ver Todos &rarr;</a>
          </div>

          <div class="space-y-12 md:space-y-16">
              {sortedPosts.map((post) => (
                  <article class="group border-b border-gray-100 pb-12 last:border-0 last:pb-0">
                      <div class="flex items-center space-x-4 mb-4">
                          <time class="text-gray-400 text-sm font-medium tracking-wide">{dateFormat(post.data.date)}</time>
                          <span class="text-gray-300">|</span>
                          {post.data.categories && (
                              <a href={`/categorias/${slugify(post.data.categories[0])}`} class="text-primary text-sm font-bold uppercase tracking-widest hover:text-dark transition">
                                  {humanize(post.data.categories[0])}
                              </a>
                          )}
                      </div>
                      <a href={`/blog/${post.id}`} class="block">
                          <h3 class="font-primary text-3xl md:text-4xl font-bold text-dark group-hover:text-primary transition-colors mb-4 leading-tight">
                              {post.data.title}
                          </h3>
                          <p class="text-gray-600 text-lg leading-relaxed md:max-w-3xl">
                              {post.data.description}
                          </p>
                      </a>
                  </article>
              ))}
          </div>
          <div class="mt-12 text-center md:hidden">
              <a href="/categorias" class="inline-block border border-gray-300 text-dark px-8 py-3 rounded hover:bg-gray-50 font-bold text-sm tracking-widest uppercase transition">Explorar Arquivo</a>
          </div>
      </div>
  </section>

  <section id="livros" class="py-20 md:py-32 px-6 bg-dark text-white">
      <div class="max-w-5xl mx-auto">
          <div class="text-center mb-16 md:mb-24">
              <span class="text-primary font-bold tracking-[0.2em] text-xs uppercase mb-4 block">A Biblioteca</span>
              <h2 class="font-primary text-4xl md:text-5xl font-bold mb-6">Manuais de Vida e Gestão</h2>
              <p class="text-gray-400 text-lg max-w-2xl mx-auto">O conhecimento não deve ter barreiras. Baixe de graça ou pague o quanto a obra valer para a sua vida.</p>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12">
              
              <div class="flex flex-col sm:flex-row bg-gray-900 border border-gray-800 rounded-2xl p-6 md:p-8 hover:border-primary/50 transition-colors group">
                  <div class="w-40 h-60 mx-auto sm:mx-0 shrink-0 bg-black rounded-lg flex flex-col items-center justify-center text-primary font-primary font-bold text-center leading-snug shadow-2xl relative overflow-hidden mb-6 sm:mb-0 sm:mr-8 border border-gray-800">
                     <span class="text-5xl opacity-10 absolute top-4">I</span>
                     <span class="z-10 px-4">O Principal<br/>Mandamento</span>
                  </div>
                  <div class="flex flex-col justify-center flex-grow text-center sm:text-left">
                      <span class="text-xs font-bold uppercase tracking-widest text-primary mb-2">Teologia</span>
                      <h3 class="font-primary text-2xl font-bold text-white mb-3">O Principal Mandamento</h3>
                      <p class="text-gray-400 text-sm mb-8 leading-relaxed">O Evangelho que o mundo não quer ouvir. Uma desconstrução do nosso orgulho diante do amor de Cristo.</p>
                      <button class="bg-white hover:bg-gray-200 text-dark w-full sm:w-auto text-center px-6 py-3 rounded font-bold transition-colors mt-auto">
                          Acessar Obra (R$ 0+)
                      </button>
                  </div>
              </div>

              <div class="flex flex-col sm:flex-row bg-gray-900 border border-gray-800 rounded-2xl p-6 md:p-8 hover:border-primary/50 transition-colors group">
                  <div class="w-40 h-60 mx-auto sm:mx-0 shrink-0 bg-gray-800 rounded-lg flex flex-col items-center justify-center text-white font-primary font-bold text-center leading-snug shadow-2xl relative overflow-hidden mb-6 sm:mb-0 sm:mr-8 border border-gray-700">
                    <span class="text-5xl opacity-10 absolute top-4">II</span>
                    <span class="z-10 px-4">Gestão de<br/>Pessoas</span>
                  </div>
                  <div class="flex flex-col justify-center flex-grow text-center sm:text-left">
                      <span class="text-xs font-bold uppercase tracking-widest text-gray-500 mb-2">Alta Performance</span>
                      <h3 class="font-primary text-2xl font-bold text-white mb-3">Gestão de Pessoas</h3>
                      <p class="text-gray-400 text-sm mb-8 leading-relaxed">Ferramentas práticas para líderes. Desvendando o potencial humano para resultados extraordinários.</p>
                      <button class="bg-white hover:bg-gray-200 text-dark w-full sm:w-auto text-center px-6 py-3 rounded font-bold transition-colors mt-auto">
                          Acessar Obra (R$ 0+)
                      </button>
                  </div>
              </div>

          </div>
      </div>
  </section>
</Base>

